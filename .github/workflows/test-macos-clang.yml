name: test-macos-clang
on:
  push:
     branches: [ stable, develop ]
     
jobs:
  build:
    runs-on: macos-latest
    steps:
    - name: checkout repository
      uses: actions/checkout@v2
      with:
        submodules: 'recursive'
    - name: install_deps
      run: |
        brew install eigen
    - name: run_tests
      id: test_result
      run: |
        cd test/
        chmod +x run_tests.sh
        ./run_tests.sh --compiler clang
    - name: check tests passed
        if: steps.test_result.outputs.result != 0
        run: exit 1